# SPDX-License-Identifier: MIT
---
- name: Ensure that the cron is set up
  hosts: all
  gather_facts: false  # test that role works in this case
  roles:
    - role: linux-system-roles.aide
      vars:
        aide_init: true
        aide_cron_check: true
        aide_cron_interval: "0 12 * * *"
  tasks:
    - name: Check file content
      ansible.builtin.lineinfile:
        path: /etc/crontab
        regexp: "^0 12 \\* \\* \\* root /usr/bin/aide --check"
        state: absent
      check_mode: true
      changed_when: false
      vars:
        __fingerprint: system_role:aide
